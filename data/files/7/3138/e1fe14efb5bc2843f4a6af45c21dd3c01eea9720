/*GIPI_WCOMM_INV_DTL*/

ALTER TABLE CPI.GIPI_WCOMM_INV_DTL
  DROP CONSTRAINT WCOMINVDTL_PK;

DROP INDEX CPI.WCOMINVDTL_PK;

ALTER TABLE CPI.GIPI_WCOMM_INV_DTL ADD (
  CONSTRAINT WCOMINVDTL_PK
  PRIMARY KEY
  (PAR_ID, ITEM_GRP,INTRMDRY_INTM_NO,TAKEUP_SEQ_NO)
  ENABLE VALIDATE);   
  
CREATE INDEX CPI.WCOMINVDTL_PK ON CPI.GIPI_WCOMM_INV_DTL
(PAR_ID, ITEM_GRP, INTRMDRY_INTM_NO, TAKEUP_SEQ_NO)
LOGGING
NOPARALLEL; 

/*GIPI_WCOMM_INV_PERILS*/

ALTER TABLE CPI.GIPI_WCOMM_INV_PERILS
  DROP CONSTRAINT WCOMM_INV_PERILS_PK;

DROP INDEX CPI.WCOMM_INV_PERILS_PK;

ALTER TABLE CPI.GIPI_WCOMM_INV_PERILS ADD (
  CONSTRAINT WCOMM_INV_PERILS_PK
  PRIMARY KEY
  (PAR_ID, ITEM_GRP,TAKEUP_SEQ_NO,INTRMDRY_INTM_NO,PERIL_CD)
  ENABLE VALIDATE);   
  
CREATE INDEX CPI.WCOMM_INV_PERILS_PK ON CPI.GIPI_WCOMM_INV_PERILS
(PAR_ID, ITEM_GRP,TAKEUP_SEQ_NO,INTRMDRY_INTM_NO,PERIL_CD)
LOGGING
NOPARALLEL;


/*GIPI_WCOMM_INVOICES*/
ALTER TABLE CPI.GIPI_WCOMM_INV_PERILS
  DROP CONSTRAINT WCOMMINV_WCOMMINVPERIL_FK;

ALTER TABLE CPI.GIPI_WCOMM_INVOICES
  DROP CONSTRAINT WCOMINV_B450_FK;
  
ALTER TABLE CPI.GIPI_WCOMM_INVOICES
  DROP CONSTRAINT INTERMEDIARY_WCOMM_INVOICES_FK;  
  
ALTER TABLE CPI.GIPI_WCOMM_INVOICES
  DROP CONSTRAINT WCOMINV_PK;
   
DROP INDEX CPI.WCOMINV_PK;

ALTER TABLE CPI.GIPI_WCOMM_INVOICES ADD (
  CONSTRAINT WCOMINV_PK
  PRIMARY KEY
  (PAR_ID, ITEM_GRP,TAKEUP_SEQ_NO,INTRMDRY_INTM_NO)
  ENABLE VALIDATE);   
  
CREATE INDEX CPI.WCOMINV_PK ON CPI.GIPI_WCOMM_INVOICES
(PAR_ID, ITEM_GRP,TAKEUP_SEQ_NO,INTRMDRY_INTM_NO)
LOGGING
NOPARALLEL;

/*GIPI_WINSTALLMENT*/
ALTER TABLE CPI.GIPI_WINSTALLMENT
  DROP CONSTRAINT WINSTALLMENT_PK;

DROP INDEX CPI.WINSTALLMENT_PK;

ALTER TABLE CPI.GIPI_WINSTALLMENT ADD (
  CONSTRAINT WINSTALLMENT_PK
  PRIMARY KEY
  (PAR_ID, ITEM_GRP,TAKEUP_SEQ_NO,INST_NO)
  ENABLE VALIDATE);   
  
CREATE INDEX CPI.WINSTALLMENT_PK ON CPI.GIPI_WINSTALLMENT
(PAR_ID, ITEM_GRP,TAKEUP_SEQ_NO,INST_NO)
LOGGING
NOPARALLEL;

/*GIPI_WINV_TAX*/
ALTER TABLE CPI.GIPI_WINV_TAX
  DROP CONSTRAINT WINV_TAX_PK;

DROP INDEX CPI.WINV_TAX_PK;

ALTER TABLE CPI.GIPI_WINV_TAX ADD (
  CONSTRAINT WINV_TAX_PK
  PRIMARY KEY
  (PAR_ID, ITEM_GRP,TAKEUP_SEQ_NO,TAX_CD)
  ENABLE VALIDATE);   
  
CREATE INDEX CPI.WINV_TAX_PK ON CPI.GIPI_WINV_TAX
(PAR_ID, ITEM_GRP,TAKEUP_SEQ_NO,TAX_CD)
LOGGING
NOPARALLEL;

/*GIPI_WINVPERL*/
ALTER TABLE CPI.GIPI_WCOMM_INV_PERILS
  DROP CONSTRAINT WINV_PERL_WCOMM_INV_PERILS;
  
ALTER TABLE CPI.GIPI_WINVPERL
  DROP CONSTRAINT WINVPERL_PK;

DROP INDEX CPI.WINVPERL_PK;

ALTER TABLE CPI.GIPI_WINVPERL ADD (
  CONSTRAINT WINVPERL_PK
  PRIMARY KEY
  (PAR_ID, ITEM_GRP,TAKEUP_SEQ_NO,PERIL_CD)
  ENABLE VALIDATE);   
  
CREATE INDEX CPI.WINVPERL_PK ON CPI.GIPI_WINVPERL
(PAR_ID, ITEM_GRP,TAKEUP_SEQ_NO,PERIL_CD)
LOGGING
NOPARALLEL;

/*GIPI_WINVOICE*/
ALTER TABLE CPI.GIPI_WINSTALLMENT
  DROP CONSTRAINT WINVOICE_WINSTALLMENT_FK;
  
ALTER TABLE CPI.GIPI_WINVPERL
  DROP CONSTRAINT WINVOICE_WINVPERL_FK;
  
ALTER TABLE CPI.GIPI_WINV_TAX
  DROP CONSTRAINT WINVOICE_WINV_TAX_FK;

ALTER TABLE CPI.GIPI_WPACKAGE_INV_TAX
  DROP CONSTRAINT WINVOICE_WPACK_INV_TAX_FK;         
  
ALTER TABLE CPI.GIPI_WINVOICE
  DROP CONSTRAINT WINVOICE_PK;

DROP INDEX CPI.WINVOICE_PK;

ALTER TABLE CPI.GIPI_WINVOICE ADD (
  CONSTRAINT WINVOICE_PK
  PRIMARY KEY
  (PAR_ID, ITEM_GRP,TAKEUP_SEQ_NO)
  ENABLE VALIDATE);   
  
CREATE INDEX CPI.WINVOICE_PK ON CPI.GIPI_WINVOICE
(PAR_ID, ITEM_GRP,TAKEUP_SEQ_NO)
LOGGING
NOPARALLEL;


/*CREATE REFERENTIAL KEYS*/
ALTER TABLE CPI.GIPI_WCOMM_INV_PERILS ADD 
CONSTRAINT WCOMMINV_WCOMMINVPERIL_FK
 FOREIGN KEY (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO, INTRMDRY_INTM_NO)
 REFERENCES CPI.GIPI_WCOMM_INVOICES (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO, INTRMDRY_INTM_NO)
 ENABLE
 VALIDATE;
 
ALTER TABLE CPI.GIPI_WCOMM_INVOICES ADD 
CONSTRAINT WCOMINV_B450_FK
 FOREIGN KEY (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO)
 REFERENCES CPI.GIPI_WINVOICE (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO)
 ENABLE
 VALIDATE; 
 
ALTER TABLE CPI.GIPI_WCOMM_INVOICES ADD 
CONSTRAINT INTERMEDIARY_WCOMM_INVOICES_FK
 FOREIGN KEY (INTRMDRY_INTM_NO)
 REFERENCES CPI.GIIS_INTERMEDIARY (INTM_NO)
 ENABLE
 VALIDATE; 
 
ALTER TABLE CPI.GIPI_WCOMM_INV_PERILS ADD 
CONSTRAINT WINV_PERL_WCOMM_INV_PERILS
 FOREIGN KEY (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO, PERIL_CD)
 REFERENCES CPI.GIPI_WINVPERL (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO, PERIL_CD)
 ENABLE
 VALIDATE; 
 
ALTER TABLE CPI.GIPI_WINSTALLMENT ADD 
CONSTRAINT WINVOICE_WINSTALLMENT_FK
 FOREIGN KEY (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO)
 REFERENCES CPI.GIPI_WINVOICE (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO)
 ENABLE
 VALIDATE; 
 
ALTER TABLE CPI.GIPI_WINVPERL ADD 
CONSTRAINT WINVOICE_WINVPERL_FK
 FOREIGN KEY (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO)
 REFERENCES CPI.GIPI_WINVOICE (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO)
 ENABLE
 VALIDATE; 
 
ALTER TABLE CPI.GIPI_WINV_TAX ADD 
CONSTRAINT WINVOICE_WINV_TAX_FK
 FOREIGN KEY (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO)
 REFERENCES CPI.GIPI_WINVOICE (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO)
 ENABLE
 VALIDATE; 
 
ALTER TABLE CPI.GIPI_WPACKAGE_INV_TAX ADD 
CONSTRAINT WINVOICE_WPACK_INV_TAX_FK
 FOREIGN KEY (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO)
 REFERENCES CPI.GIPI_WINVOICE (PAR_ID, ITEM_GRP, TAKEUP_SEQ_NO)
 ENABLE
 VALIDATE; 